tinymce.PluginManager.add("importcss",function(t){function e(e){function s(t,e){(e||c[t.href])&&(n(t.imports,function(t){s(t,!0)}),n(t.cssRules||t.rules,function(t){t.styleSheet?s(t.styleSheet,!0):t.selectorText&&n(t.selectorText.split(","),function(t){i.push(tinymce.trim(t))})}))}var i=[],c={};n(t.contentCSS,function(t){c[t]=!0});try{n(e.styleSheets,s)}catch(r){}return i}function s(e){var s,n=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(e);if(n){var i=n[1],c=n[2].substr(1).split(".").join(" ");return n[1]?(s={title:e},t.schema.getTextBlockElements()[i]?s.block=i:t.schema.getBlockElements()[i]?s.selector=i:s.inline=i):n[2]&&(s={inline:"span",title:e.substr(1),classes:c}),t.settings.importcss_merge_classes!==!1?s.classes=c:s.attributes={"class":c},s}}var n=tinymce.each;t.settings.style_formats||t.on("renderFormatsMenu",function(i){var c=t.settings.importcss_selector_converter||s,r={};t.settings.importcss_append||i.control.items().remove(),n(e(t.getDoc()),function(e){if(-1===e.indexOf(".mce-")&&!r[e]){var s=c(e);if(s){var n=s.name||tinymce.DOM.uniqueId();t.formatter.register(n,s),i.control.append(tinymce.extend({},i.control.settings.itemDefaults,{text:s.title,format:n}))}r[e]=!0}})})});